# План проекта: Расширение "Chrome-bot"

**Цель:** Создать Chrome-расширение, которое анализирует контент активной вкладки, генерирует поисковые запросы с помощью ИИ и находит контекстную информацию в интернете через API `exa.ai`. Бэкенд на Python (FastAPI) для безопасной работы с ключами и интеграциями.

---

### Этап 1: Подготовка и создание структуры проекта

1) Расширение (MV3)
- `manifest.json`: `manifest_version: 3`, `name: Chrome-bot`, `permissions: [activeTab, scripting, storage]`, `host_permissions` на URL бэкенда (например, `http://localhost:8000/*`), `background.service_worker: background.js`, `action.default_popup: popup.html`, `options_page: options.html`.
- Основные файлы: `popup.html`, `popup.js`, `background.js`, `content.js`, `options.html`, `options.js`.

2) Бэкенд (Python / FastAPI)
- Структура: `backend/app/main.py`, `backend/requirements.txt`.
- Эндпоинт `/analyze`: вход — текст страницы/метаданные; выход — один сжатый поисковый запрос + результаты из `exa.ai`.

---

### Этап 2: Извлечение контента со страницы (расширение)

- `popup.js`: кнопка "Анализировать" запускает сценарий.
- `background.js`: по команде запускает `content.js` через `chrome.scripting.executeScript` и ожидает сообщение с контентом.
- `content.js`: извлекает `document.body.innerText` (с ограничением длины), `document.title`, `location.href`; отправляет сообщение в background.

---

### Этап 3: Генерация поискового запроса (бэкенд)

- В `FastAPI` реализовать функцию генерации запроса: передать текст в модель ИИ (в проде), временно — эвристика/резервный вариант без ИИ.
- Держать ключи провайдеров ИИ только на сервере (переменные окружения).

---

### Этап 4: Интеграция с exa.ai (бэкенд)

- Использовать API `exa.ai` для поиска (ключ — в переменных окружения сервера).
- Обработать ответ и нормализовать: `title`, `url`, `snippet`/фрагменты.

Справочно: платформа `exa.ai` предлагает Search/Websets/Answer/Research и ориентирована на ИИ-продукты — см. сайт: `https://exa.ai/`.

---

### Этап 5: Отображение результатов (расширение)

- `background.js` отправляет результат во `popup.js`.
- `popup.js` рендерит список ссылок, краткие описания, индикатор загрузки/ошибок.

---

### Этап 6: Настройки и безопасность

- `options.html/js`: ввод и сохранение URL бэкенда в `chrome.storage.local`.
- Все секреты (ИИ, `exa.ai`) — только на бэкенде.
- CORS на бэкенде для доменов разработки и продакшена.

---

### Этап 7: Деплой и тестирование

- Бэкенд: Docker/uvicorn, хостинг (Railway/Fly/Render/VPS). Логи, кеши, при необходимости rate-limit.
- Расширение: загрузка как unpacked для разработки; подготовка к публикации в Chrome Web Store.
- Тестирование: сценарии без текста, большие страницы, сетевые ошибки, релевантность запросов.

---

### Этап 8: Документация

- README с инструкциями по запуску бэкенда (venv, переменные окружения, запуск uvicorn) и установке расширения.

---

### Источники

- О продукте и API возможностей `exa.ai`: `https://exa.ai/`




